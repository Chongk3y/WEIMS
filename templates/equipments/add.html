{% extends 'base.html' %}
{% block title %}Add Equipment{% endblock %}
{% load static %}
{% block content %}

{% if error %}
<div class="alert alert-danger small py-2 px-3 my-2">{{ error }}</div>
{% endif %}

<div class="container-fluid px-2" style="max-width: 100vw;">
  <div class="card shadow-sm">

    <div class="card-body p-2">
      <form action="{% url 'equipments:processaddequipment' %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="row g-2">

          <!-- üõ† Equipment Details -->
          <div class="col-12 small fw-bold text-secondary mt-2">üõ† Equipment Details</div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Image</label>
            <input type="file" class="form-control form-control-sm" name="user_image">
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Property #</label>
            <input type="text" name="item_propertynum" class="form-control form-control-sm" value="{{ values.item_propertynum|default_if_none:'' }}" required>
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Item Name</label>
            <input type="text" name="item_name" class="form-control form-control-sm" value="{{ values.item_name|default_if_none:'' }}" required>
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Description</label>
            <input type="text" name="item_desc" class="form-control form-control-sm" value="{{ values.item_desc|default_if_none:'' }}">
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Additional Info</label>
            <input type="text" name="additional_info" class="form-control form-control-sm" value="{{ values.additional_info|default_if_none:'' }}">
          </div>

          <!-- üßæ Purchase Details -->
          <div class="col-12 small fw-bold text-secondary mt-2">üßæ Purchase Details</div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">PO #</label>
            <input type="text" name="po_number" class="form-control form-control-sm" value="{{ values.po_number|default_if_none:'' }}">
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Fund Source</label>
            <input type="text" name="fund_source" class="form-control form-control-sm" value="{{ values.fund_source|default_if_none:'' }}">
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Supplier</label>
            <input type="text" name="supplier" class="form-control form-control-sm" value="{{ values.supplier|default_if_none:'' }}">
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Amount (‚Ç±)</label>
            <input type="number" step="0.01" name="item_amount" class="form-control form-control-sm" value="{{ values.item_amount|default_if_none:'' }}">
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Purchase Date</label>
            <input type="date" name="item_purdate" class="form-control form-control-sm" value="{{ values.item_purdate|default_if_none:'' }}">
          </div>

          <!-- üìç Project & Assignment -->
          <div class="col-12 small fw-bold text-secondary mt-2">üìç Project & Assignment</div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Project Name</label>
            <input type="text" name="project_name" class="form-control form-control-sm" value="{{ values.project_name|default_if_none:'' }}">
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Assigned To</label>
            <input type="text" name="assigned_to" class="form-control form-control-sm" value="{{ values.assigned_to|default_if_none:'' }}">
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">End User</label>
            <input type="text" name="end_user" class="form-control form-control-sm" value="{{ values.end_user|default_if_none:'' }}">
          </div>

          <!-- üó∫ Location Info -->
          <div class="col-12 small fw-bold text-secondary mt-2">üìå Location Info</div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Deployment Location</label>
            <input type="text" name="location" class="form-control form-control-sm" value="{{ values.location|default_if_none:'' }}">
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Current Location</label>
            <input type="text" name="current_location" class="form-control form-control-sm" value="{{ values.current_location|default_if_none:'' }}">
          </div>

          <!-- üóÇ Classification -->
          <div class="col-12 small fw-bold text-secondary mt-2">üóÇ Classification</div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Category</label>
            <select name="category_id" class="form-select form-select-sm">
              {% for cat in categories %}
              <option value="{{ cat.id }}" {% if values.category_id == cat.id|stringformat:"s" %}selected{% endif %}>{{ cat.name }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="col-sm-6">
            <label class="form-label small mb-1">Status</label>
            <select name="status_id" class="form-select form-select-sm">
              {% for stat in statuses %}
              <option value="{{ stat.id }}" {% if values.status_id == stat.id|stringformat:"s" %}selected{% endif %}>{{ stat.name }}</option>
              {% endfor %}
            </select>
          </div>

          <!-- üîò Buttons -->
          <div class="col-12 text-end mt-2">
            {% if is_admin or is_encoder %}
              <a href="{% url 'equipments:index' %}" class="btn btn-sm btn-outline-secondary px-4">Cancel</a>
              <button type="submit" class="btn btn-sm btn-custom px-4">Save</button>
            {% endif %}
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
